/*
 * Copyright (C) 2014 Eric A. Cottrell <eric.c.boston@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
 * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
 * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 */
#include "dsd.h"
#include "dmr_const.h"

// Table based error correction code for dmr


// Golay (20,8)

static long Golay208Gen[8] = {0x803da, 0x40d99, 0x206cd, 0x10367, 0x08dc6, 0x04a97, 0x0293e, 0x018eb};
static long Golay208Table[4096] = {

0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0x0, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x0, 0x18, 0x19, 0x1A, 0x0, 0x1C, 0x0, 0x0, 0x4801F, 
0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x0, 0x28, 0x29, 0x2A, 0x0, 0x2C, 0x0, 0x0, 0x0, 0x30, 0x31, 0x32, 0x0, 0x34, 0x0, 0x0, 0x0, 0x38, 0x0, 0x0, 0x0, 0x0, 0x9003D, 0x203E, 0x0, 
0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x0, 0x48, 0x49, 0x4A, 0x0, 0x4C, 0x0, 0x0, 0x4804F, 0x50, 0x51, 0x52, 0x0, 0x54, 0x0, 0x0, 0x48057, 0x58, 0x0, 0x0, 0x4805B, 0x0, 0x4805D, 0x4805E, 0x4805F, 
0x60, 0x61, 0x62, 0x0, 0x64, 0x0, 0x0, 0x10067, 0x68, 0x0, 0x0, 0x106B, 0x0, 0x0, 0x0, 0x0, 0x70, 0x0, 0x0, 0x86073, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x507C, 0x0, 0x0, 0x4807F, 
0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x0, 0x88, 0x89, 0x8A, 0x0, 0x8C, 0x0, 0x0, 0x0, 0x90, 0x91, 0x92, 0x0, 0x94, 0x0, 0x0, 0x4097, 0x98, 0x0, 0x0, 0x0, 0x0, 0x9009D, 0x0, 0x0, 
0xA0, 0xA1, 0xA2, 0x0, 0xA4, 0x0, 0x0, 0x420A7, 0xA8, 0x0, 0x0, 0x10AB, 0x0, 0x900AD, 0x0, 0x0, 0xB0, 0x0, 0x0, 0x0, 0x0, 0x900B5, 0x0, 0x0, 0x0, 0x900B9, 0x0, 0x0, 0x900BC, 0x900BD, 0x0, 0x900BF, 
0xC0, 0xC1, 0xC2, 0x0, 0xC4, 0x0, 0x0, 0x0, 0xC8, 0x0, 0x0, 0x10CB, 0x0, 0x200CD, 0x160CE, 0x0, 0xD0, 0x0, 0x0, 0x0, 0x0, 0x30D5, 0x0, 0x0, 0x0, 0x0, 0x800DA, 0x0, 0x0, 0x0, 0x0, 0x480DF, 
0xE0, 0x0, 0x0, 0x10E3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10E9, 0x10EA, 0x10EB, 0x0, 0x0, 0x0, 0x10EF, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA0F8, 0x0, 0x0, 0x10FB, 0x0, 0x900FD, 0x0, 0x0, 
0x100, 0x101, 0x102, 0x103, 0x104, 0x105, 0x106, 0x0, 0x108, 0x109, 0x10A, 0x0, 0x10C, 0x0, 0x0, 0x0, 0x110, 0x111, 0x112, 0x0, 0x114, 0x0, 0x0, 0xA0117, 0x118, 0x0, 0x0, 0x1511B, 0x0, 0x0, 0x211E, 0x0, 
0x120, 0x121, 0x122, 0x0, 0x124, 0x0, 0x0, 0x10127, 0x128, 0x0, 0x0, 0x0, 0x0, 0x912D, 0x212E, 0x0, 0x130, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2136, 0x0, 0x0, 0x0, 0x213A, 0x0, 0x213C, 0x0, 0x213E, 0x213F, 
0x140, 0x141, 0x142, 0x0, 0x144, 0x0, 0x0, 0x10147, 0x148, 0x0, 0x0, 0x0, 0x0, 0x8414D, 0x0, 0x0, 0x150, 0x0, 0x0, 0x0, 0x0, 0x3155, 0x0, 0x0, 0x0, 0x0, 0x8015A, 0x0, 0x0, 0x0, 0x0, 0x4815F, 
0x160, 0x0, 0x0, 0x10163, 0x0, 0x10165, 0x10166, 0x10167, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1016F, 0x0, 0x0, 0x41172, 0x0, 0x0, 0x0, 0x0, 0x10177, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x217E, 0x0, 
0x180, 0x181, 0x182, 0x0, 0x184, 0x0, 0x0, 0x0, 0x188, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x190, 0x0, 0x0, 0x0, 0x0, 0x3195, 0x0, 0x0, 0x0, 0x40199, 0x8019A, 0x0, 0x2C19C, 0x0, 0x0, 0x0, 
0x1A0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x851A6, 0x0, 0x0, 0x61A9, 0x301AA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x901BD, 0x21BE, 0x0, 
0x1C0, 0x0, 0x0, 0x641C3, 0x0, 0x31C5, 0x81C6, 0x0, 0x0, 0x0, 0x801CA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x31D1, 0x801D2, 0x0, 0x31D4, 0x31D5, 0x0, 0x31D7, 0x801D8, 0x0, 0x801DA, 0x801DB, 0x0, 0x31DD, 0x801DE, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x101E7, 0x0, 0x0, 0x0, 0x11EB, 0x0, 0x0, 0x0, 0x0, 0x141F0, 0x0, 0x0, 0x0, 0x0, 0x31F5, 0x0, 0x0, 0x0, 0x0, 0x801FA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x200, 0x201, 0x202, 0x203, 0x204, 0x205, 0x206, 0x0, 0x208, 0x209, 0x20A, 0x0, 0x20C, 0x0, 0x0, 0x8320F, 0x210, 0x211, 0x212, 0x0, 0x214, 0x0, 0x0, 0x4217, 0x218, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x220, 0x221, 0x222, 0x0, 0x224, 0x0, 0x0, 0x10227, 0x228, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x230, 0x0, 0x0, 0x0, 0x0, 0x2A235, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x523C, 0x0, 0x0, 0x0, 
0x240, 0x241, 0x242, 0x0, 0x244, 0x0, 0x0, 0x10247, 0x248, 0x0, 0x0, 0x0, 0x0, 0x2024D, 0x0, 0x0, 0x250, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x12259, 0x8025A, 0x0, 0x525C, 0x0, 0x0, 0x4825F, 
0x260, 0x0, 0x0, 0x10263, 0x0, 0x10265, 0x10266, 0x10267, 0x0, 0x0, 0x6226A, 0x0, 0x526C, 0x0, 0x0, 0x1026F, 0x0, 0x0, 0x0, 0x0, 0x5274, 0x0, 0x0, 0x10277, 0x5278, 0x0, 0x0, 0x0, 0x527C, 0x527D, 0x527E, 0x0, 
0x280, 0x281, 0x282, 0x0, 0x284, 0x0, 0x0, 0x4287, 0x288, 0x0, 0x0, 0x0, 0x0, 0x2028D, 0x0, 0x0, 0x290, 0x0, 0x0, 0x4293, 0x0, 0x4295, 0x4296, 0x4297, 0x0, 0x0, 0x8029A, 0x0, 0x0, 0x0, 0x0, 0x429F, 
0x2A0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x62A9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x132B2, 0x0, 0x0, 0x0, 0x0, 0x42B7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x902BD, 0x0, 0x0, 
0x2C0, 0x0, 0x0, 0x0, 0x0, 0x202C5, 0x0, 0x0, 0x0, 0x202C9, 0x802CA, 0x0, 0x202CC, 0x202CD, 0x0, 0x202CF, 0x0, 0x0, 0x802D2, 0x0, 0x0, 0x0, 0x0, 0x42D7, 0x802D8, 0x0, 0x802DA, 0x802DB, 0x0, 0x202DD, 0x802DE, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x822E4, 0x0, 0x0, 0x102E7, 0x0, 0x0, 0x0, 0x12EB, 0x0, 0x202ED, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x802FA, 0x0, 0x52FC, 0x0, 0x0, 0x0, 
0x300, 0x301, 0x302, 0x0, 0x304, 0x0, 0x0, 0x10307, 0x308, 0x0, 0x0, 0x2830B, 0x0, 0x0, 0x4430E, 0x0, 0x310, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8031A, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x320, 0x0, 0x0, 0x10323, 0x0, 0x10325, 0x10326, 0x10327, 0x0, 0x6329, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1032F, 0x0, 0x81331, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10337, 0x58338, 0x0, 0x0, 0x0, 0x0, 0x0, 0x233E, 0x0, 
0x340, 0x0, 0x0, 0x10343, 0x0, 0x10345, 0x10346, 0x10347, 0x0, 0x0, 0x8034A, 0x0, 0x0, 0x0, 0x0, 0x1034F, 0x0, 0xC351, 0x80352, 0x0, 0x60354, 0x0, 0x0, 0x10357, 0x80358, 0x0, 0x8035A, 0x8035B, 0x0, 0x0, 0x8035E, 0x0, 
0x0, 0x10361, 0x10362, 0x10363, 0x10364, 0x10365, 0x10366, 0x10367, 0x0, 0x0, 0x0, 0x1036B, 0x0, 0x1036D, 0x1036E, 0x1036F, 0x0, 0x0, 0x0, 0x10373, 0x0, 0x10375, 0x10376, 0x10377, 0x0, 0x0, 0x8037A, 0x0, 0x537C, 0x0, 0x0, 0x1037F, 
0x380, 0x0, 0x0, 0x0, 0x0, 0xC8385, 0x0, 0x0, 0x0, 0x6389, 0x8038A, 0x0, 0x1138C, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80392, 0x0, 0x0, 0x0, 0x0, 0x4397, 0x80398, 0x0, 0x8039A, 0x8039B, 0x0, 0x0, 0x8039E, 0x0, 
0x0, 0x63A1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x103A7, 0x63A8, 0x63A9, 0x0, 0x63AB, 0x0, 0x63AD, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x63B9, 0x803BA, 0x0, 0x0, 0x0, 0x0, 0x613BF, 
0x0, 0x0, 0x803C2, 0x0, 0x0, 0x0, 0x0, 0x103C7, 0x803C8, 0x0, 0x803CA, 0x803CB, 0x0, 0x203CD, 0x803CE, 0x0, 0x803D0, 0x0, 0x803D2, 0x803D3, 0x0, 0x33D5, 0x803D6, 0x0, 0x803D8, 0x803D9, 0x803DA, 0x803DB, 0x803DC, 0x0, 0x803DE, 0x803DF, 
0x293E0, 0x0, 0x0, 0x103E3, 0x0, 0x103E5, 0x103E6, 0x103E7, 0x0, 0x63E9, 0x803EA, 0x0, 0x0, 0x0, 0x0, 0x103EF, 0x0, 0x0, 0x803F2, 0x0, 0x0, 0x0, 0x0, 0x103F7, 0x803F8, 0x0, 0x803FA, 0x803FB, 0x0, 0x0, 0x803FE, 0x0, 
0x400, 0x401, 0x402, 0x403, 0x404, 0x405, 0x406, 0x0, 0x408, 0x409, 0x40A, 0x0, 0x40C, 0x0, 0x0, 0x0, 0x410, 0x411, 0x412, 0x0, 0x414, 0x0, 0x0, 0xA0417, 0x418, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x420, 0x421, 0x422, 0x0, 0x424, 0x0, 0x0, 0x42427, 0x428, 0x0, 0x0, 0x0, 0x0, 0x942D, 0x0, 0x0, 0x430, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1C436, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x440, 0x441, 0x442, 0x0, 0x444, 0x0, 0x0, 0x0, 0x448, 0x0, 0x0, 0x0, 0x0, 0x2044D, 0x0, 0x0, 0x450, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2445A, 0x0, 0x0, 0x0, 0x0, 0x4845F, 
0x460, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x54469, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x41472, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA478, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x480, 0x481, 0x482, 0x0, 0x484, 0x0, 0x0, 0x42487, 0x488, 0x0, 0x0, 0x8C48B, 0x0, 0x2048D, 0x0, 0x0, 0x490, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40499, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x4A0, 0x0, 0x0, 0x424A3, 0x0, 0x424A5, 0x424A6, 0x424A7, 0x0, 0x0, 0x304AA, 0x0, 0x0, 0x0, 0x0, 0x424AF, 0x0, 0x254B1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x424B7, 0xA4B8, 0x0, 0x0, 0x0, 0x0, 0x904BD, 0x0, 0x0, 
0x4C0, 0x0, 0x0, 0x0, 0x0, 0x204C5, 0x84C6, 0x0, 0x0, 0x204C9, 0x0, 0x0, 0x204CC, 0x204CD, 0x0, 0x204CF, 0x0, 0x0, 0x0, 0x0, 0xC44D4, 0x0, 0x0, 0x0, 0xA4D8, 0x0, 0x0, 0x0, 0x0, 0x204DD, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x424E7, 0xA4E8, 0x0, 0x0, 0x14EB, 0x0, 0x204ED, 0x0, 0x0, 0xA4F0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA4F8, 0xA4F9, 0xA4FA, 0x0, 0xA4FC, 0x0, 0x0, 0x0, 
0x500, 0x501, 0x502, 0x0, 0x504, 0x0, 0x0, 0xA0507, 0x508, 0x0, 0x0, 0x0, 0x0, 0x950D, 0x4450E, 0x0, 0x510, 0x0, 0x0, 0xA0513, 0x0, 0xA0515, 0xA0516, 0xA0517, 0x0, 0x40519, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA051F, 
0x520, 0x0, 0x0, 0x0, 0x0, 0x9525, 0x0, 0x0, 0x0, 0x9529, 0x3052A, 0x0, 0x952C, 0x952D, 0x0, 0x952F, 0x0, 0x0, 0x41532, 0x0, 0x0, 0x0, 0x0, 0xA0537, 0x0, 0x0, 0x0, 0x0, 0x0, 0x953D, 0x253E, 0x0, 
0x540, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8546, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xC551, 0x41552, 0x0, 0x0, 0x0, 0x0, 0xA0557, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x41562, 0x0, 0x26564, 0x0, 0x0, 0x10567, 0x0, 0x0, 0x0, 0x0, 0x0, 0x956D, 0x0, 0x0, 0x41570, 0x0, 0x41572, 0x41573, 0x0, 0x0, 0x41576, 0x0, 0x0, 0x0, 0x4157A, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x580, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8586, 0x0, 0x0, 0x40589, 0x3058A, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40591, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA0597, 0x40598, 0x40599, 0x0, 0x4059B, 0x0, 0x4059D, 0x0, 0x0, 
0x0, 0x0, 0x305A2, 0x0, 0x0, 0x0, 0x0, 0x425A7, 0x305A8, 0x0, 0x305AA, 0x305AB, 0x0, 0x95AD, 0x305AE, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x405B9, 0x305BA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x85C2, 0x0, 0x85C4, 0x0, 0x85C6, 0x85C7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x205CD, 0x85CE, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x35D5, 0x85D6, 0x0, 0x0, 0x405D9, 0x805DA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x85E6, 0x0, 0x0, 0x0, 0x305EA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x415F2, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA5F8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x600, 0x601, 0x602, 0x0, 0x604, 0x0, 0x0, 0x0, 0x608, 0x0, 0x0, 0x0, 0x0, 0x2060D, 0x4460E, 0x0, 0x610, 0x0, 0x0, 0x0, 0x0, 0x51615, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8861C, 0x0, 0x0, 0x0, 
0x620, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21626, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x640, 0x0, 0x0, 0xC0643, 0x0, 0x20645, 0x0, 0x0, 0x0, 0x20649, 0x1964A, 0x0, 0x2064C, 0x2064D, 0x0, 0x2064F, 0x0, 0xC651, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2065D, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10667, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2066D, 0x0, 0x0, 0xB0670, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x567C, 0x0, 0x0, 0x0, 
0x680, 0x0, 0x0, 0x0, 0x0, 0x20685, 0x0, 0x0, 0x0, 0x20689, 0x0, 0x0, 0x2068C, 0x2068D, 0x0, 0x2068F, 0x0, 0x0, 0x68692, 0x0, 0x0, 0x0, 0x0, 0x4697, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2069D, 0x0, 0x0, 
0x0, 0x186A1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x426A7, 0xC16A8, 0x0, 0x0, 0x0, 0x0, 0x206AD, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x206C1, 0x0, 0x0, 0x206C4, 0x206C5, 0x0, 0x206C7, 0x206C8, 0x206C9, 0x0, 0x206CB, 0x206CC, 0x206CD, 0x206CE, 0x206CF, 0x0, 0x0, 0x0, 0x0, 0x0, 0x206D5, 0x0, 0x0, 0x0, 0x206D9, 0x806DA, 0x0, 0x206DC, 0x206DD, 0x0, 0x206DF, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x206E5, 0x0, 0x0, 0x0, 0x206E9, 0x0, 0x0, 0x206EC, 0x206ED, 0x0, 0x206EF, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x896F7, 0xA6F8, 0x0, 0x0, 0x0, 0x0, 0x206FD, 0x506FE, 0x0, 
0x700, 0x0, 0x0, 0x0, 0x0, 0x0, 0x44706, 0x0, 0x0, 0x0, 0x4470A, 0x0, 0x4470C, 0x0, 0x4470E, 0x4470F, 0x0, 0xC711, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA0717, 0x23718, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4471E, 0x0, 
0x0, 0x0, 0x8A722, 0x0, 0x0, 0x0, 0x0, 0x10727, 0x0, 0x0, 0x0, 0x0, 0x0, 0x972D, 0x4472E, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0xC741, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10747, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2074D, 0x4474E, 0x0, 0xC750, 0xC751, 0x0, 0xC753, 0x0, 0xC755, 0x0, 0x0, 0x0, 0xC759, 0x8075A, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x10763, 0x0, 0x10765, 0x10766, 0x10767, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1076F, 0x0, 0xC771, 0x41772, 0x0, 0x0, 0x0, 0x0, 0x10777, 0x0, 0x0, 0x0, 0x0, 0x0, 0xC277D, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2078D, 0x4478E, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40799, 0x8079A, 0x0, 0x0, 0x0, 0x0, 0x1A79F, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x67A9, 0x307AA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x527C0, 0x0, 0x0, 0x0, 0x0, 0x207C5, 0x87C6, 0x0, 0x0, 0x207C9, 0x807CA, 0x0, 0x207CC, 0x207CD, 0x0, 0x207CF, 0x0, 0xC7D1, 0x807D2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x807D8, 0x0, 0x807DA, 0x807DB, 0x0, 0x207DD, 0x807DE, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x107E7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x207ED, 0x0, 0x0, 0x0, 0x0, 0x0, 0x227F3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x807FA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x800, 0x801, 0x802, 0x803, 0x804, 0x805, 0x806, 0x0, 0x808, 0x809, 0x80A, 0x0, 0x80C, 0x0, 0x0, 0x0, 0x810, 0x811, 0x812, 0x0, 0x814, 0x0, 0x0, 0x4817, 0x818, 0x0, 0x0, 0x0, 0x0, 0x0, 0x281E, 0x0, 
0x820, 0x821, 0x822, 0x0, 0x824, 0x0, 0x0, 0x0, 0x828, 0x0, 0x0, 0x182B, 0x0, 0x0, 0x282E, 0x0, 0x830, 0x0, 0x0, 0x70833, 0x0, 0x0, 0x2836, 0x0, 0x0, 0x0, 0x283A, 0x0, 0x283C, 0x0, 0x283E, 0x283F, 
0x840, 0x841, 0x842, 0x0, 0x844, 0x0, 0x0, 0x0, 0x848, 0x0, 0x0, 0x184B, 0x0, 0x8484D, 0x0, 0x0, 0x850, 0x0, 0x0, 0x0, 0x0, 0x0, 0x91856, 0x0, 0x0, 0x12859, 0x2485A, 0x0, 0x0, 0x0, 0x0, 0x4885F, 
0x860, 0x0, 0x0, 0x1863, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1869, 0x186A, 0x186B, 0x3886C, 0x0, 0x0, 0x186F, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x187B, 0x0, 0x0, 0x287E, 0x0, 
0x880, 0x881, 0x882, 0x0, 0x884, 0x0, 0x0, 0x4887, 0x888, 0x0, 0x0, 0x188B, 0x0, 0x0, 0xE088E, 0x0, 0x890, 0x0, 0x0, 0x4893, 0x0, 0x4895, 0x4896, 0x4897, 0x0, 0x40899, 0x0, 0x0, 0x0, 0x0, 0x0, 0x489F, 
0x8A0, 0x0, 0x0, 0x18A3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x18A9, 0x18AA, 0x18AB, 0x0, 0x0, 0x0, 0x18AF, 0x0, 0x0, 0x0, 0x0, 0x498B4, 0x0, 0x0, 0x48B7, 0x0, 0x0, 0x0, 0x18BB, 0x0, 0x908BD, 0x28BE, 0x0, 
0x8C0, 0x0, 0x0, 0x18C3, 0x0, 0x0, 0x88C6, 0x0, 0x0, 0x18C9, 0x18CA, 0x18CB, 0x0, 0x0, 0x0, 0x18CF, 0x0, 0xA88D1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x48D7, 0x0, 0x0, 0x0, 0x18DB, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x18E1, 0x18E2, 0x18E3, 0x828E4, 0x0, 0x0, 0x18E7, 0x18E8, 0x18E9, 0x18EA, 0x18EB, 0x0, 0x18ED, 0x18EE, 0x18EF, 0x148F0, 0x0, 0x0, 0x18F3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x18F9, 0x18FA, 0x18FB, 0x0, 0x0, 0x0, 0x18FF, 
0x900, 0x901, 0x902, 0x0, 0x904, 0x0, 0x0, 0x0, 0x908, 0x0, 0x0, 0x2890B, 0x0, 0x8490D, 0x290E, 0x0, 0x910, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2916, 0x0, 0x0, 0x40919, 0x291A, 0x0, 0x291C, 0x0, 0x291E, 0x291F, 
0x920, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2926, 0x0, 0x0, 0x0, 0x292A, 0x0, 0x292C, 0x0, 0x292E, 0x292F, 0x0, 0x81931, 0x2932, 0x0, 0x2934, 0x0, 0x2936, 0x2937, 0x2938, 0x0, 0x293A, 0x293B, 0x293C, 0x293D, 0x293E, 0x293F, 
0x940, 0x0, 0x0, 0x0, 0x0, 0x84945, 0x8946, 0x0, 0x0, 0x84949, 0x0, 0x0, 0x8494C, 0x8494D, 0x0, 0x8494F, 0x0, 0x0, 0x0, 0x0, 0x60954, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8495D, 0x295E, 0x0, 
0x0, 0x4A961, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10967, 0x0, 0x0, 0x0, 0x196B, 0x0, 0x8496D, 0x296E, 0x0, 0x14970, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2976, 0x0, 0x0, 0x0, 0x297A, 0x0, 0x297C, 0x0, 0x297E, 0x297F, 
0x980, 0x0, 0x0, 0x92983, 0x0, 0x0, 0x8986, 0x0, 0x0, 0x40989, 0x0, 0x0, 0x1198C, 0x0, 0x0, 0x0, 0x0, 0x40991, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4997, 0x40998, 0x40999, 0x0, 0x4099B, 0x0, 0x4099D, 0x299E, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x19AB, 0x0, 0x0, 0x29AE, 0x0, 0x149B0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x29B6, 0x0, 0x0, 0x409B9, 0x29BA, 0x0, 0x29BC, 0x0, 0x29BE, 0x29BF, 
0x0, 0x0, 0x89C2, 0x0, 0x89C4, 0x0, 0x89C6, 0x89C7, 0x0, 0x0, 0x0, 0x19CB, 0x0, 0x849CD, 0x89CE, 0x0, 0x149D0, 0x0, 0x0, 0x0, 0x0, 0x39D5, 0x89D6, 0x0, 0x0, 0x409D9, 0x809DA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x149E0, 0x0, 0x0, 0x19E3, 0x0, 0x0, 0x89E6, 0x0, 0x0, 0x19E9, 0x19EA, 0x19EB, 0x0, 0x0, 0x0, 0x19EF, 0x149F0, 0x149F1, 0x149F2, 0x0, 0x149F4, 0x0, 0x0, 0x0, 0x149F8, 0x0, 0x0, 0x19FB, 0x0, 0x0, 0x29FE, 0x0, 
0xA00, 0xA01, 0xA02, 0x0, 0xA04, 0x0, 0x0, 0x4A07, 0xA08, 0x0, 0x0, 0x28A0B, 0x0, 0x0, 0x0, 0x0, 0xA10, 0x0, 0x0, 0x4A13, 0x0, 0x4A15, 0x4A16, 0x4A17, 0x0, 0x12A19, 0x0, 0x0, 0x88A1C, 0x0, 0x0, 0x4A1F, 
0xA20, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21A26, 0x0, 0x0, 0x0, 0x94A2A, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x81A31, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4A37, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2A3E, 0x0, 
0xA40, 0x0, 0x0, 0xC0A43, 0x0, 0x0, 0x0, 0x0, 0x0, 0x12A49, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x12A51, 0x0, 0x0, 0x60A54, 0x0, 0x0, 0x4A57, 0x12A58, 0x12A59, 0x0, 0x12A5B, 0x0, 0x12A5D, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x82A64, 0x0, 0x0, 0x10A67, 0x0, 0x0, 0x0, 0x1A6B, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x12A79, 0x0, 0x0, 0x5A7C, 0x0, 0x0, 0x0, 
0xA80, 0x0, 0x0, 0x4A83, 0x0, 0x4A85, 0x4A86, 0x4A87, 0x0, 0x0, 0x0, 0x0, 0x11A8C, 0x0, 0x0, 0x4A8F, 0x0, 0x4A91, 0x4A92, 0x4A93, 0x4A94, 0x4A95, 0x4A96, 0x4A97, 0x0, 0x0, 0x0, 0x4A9B, 0x0, 0x4A9D, 0x4A9E, 0x4A9F, 
0x0, 0x18AA1, 0x0, 0x0, 0x82AA4, 0x0, 0x0, 0x4AA7, 0x0, 0x0, 0x0, 0x1AAB, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4AB3, 0x0, 0x4AB5, 0x4AB6, 0x4AB7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4ABF, 
0x0, 0x0, 0x0, 0x0, 0x82AC4, 0x0, 0x0, 0x4AC7, 0x4CAC8, 0x0, 0x0, 0x1ACB, 0x0, 0x20ACD, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4AD3, 0x0, 0x4AD5, 0x4AD6, 0x4AD7, 0x0, 0x12AD9, 0x80ADA, 0x0, 0x0, 0x0, 0x0, 0x4ADF, 
0x82AE0, 0x0, 0x0, 0x1AE3, 0x82AE4, 0x82AE5, 0x82AE6, 0x0, 0x0, 0x1AE9, 0x1AEA, 0x1AEB, 0x82AEC, 0x0, 0x0, 0x1AEF, 0x0, 0x0, 0x0, 0x0, 0x82AF4, 0x0, 0x0, 0x4AF7, 0x0, 0x0, 0x0, 0x1AFB, 0x0, 0x0, 0x50AFE, 0x0, 
0xB00, 0x0, 0x0, 0x28B03, 0x0, 0x0, 0x0, 0x0, 0x0, 0x28B09, 0x28B0A, 0x28B0B, 0x11B0C, 0x0, 0x0, 0x28B0F, 0x0, 0x81B11, 0x0, 0x0, 0x60B14, 0x0, 0x0, 0x4B17, 0x0, 0x0, 0x0, 0x28B1B, 0x0, 0x0, 0x2B1E, 0x0, 
0x0, 0x81B21, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10B27, 0x0, 0x0, 0x0, 0x28B2B, 0x0, 0x0, 0x2B2E, 0x0, 0x81B30, 0x81B31, 0x0, 0x81B33, 0x0, 0x81B35, 0x2B36, 0x0, 0x0, 0x81B39, 0x2B3A, 0x0, 0x2B3C, 0x0, 0x2B3E, 0x2B3F, 
0x0, 0x0, 0x7B42, 0x0, 0x60B44, 0x0, 0x0, 0x10B47, 0x0, 0x0, 0x0, 0x28B4B, 0x0, 0x84B4D, 0x0, 0x0, 0x60B50, 0x0, 0x0, 0x0, 0x60B54, 0x60B55, 0x60B56, 0x0, 0x0, 0x12B59, 0x80B5A, 0x0, 0x60B5C, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x10B63, 0x0, 0x10B65, 0x10B66, 0x10B67, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10B6F, 0x0, 0x81B71, 0x0, 0x0, 0x60B74, 0x0, 0x0, 0x10B77, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2B7E, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x11B84, 0x0, 0x0, 0x4B87, 0x11B88, 0x0, 0x0, 0x28B8B, 0x11B8C, 0x11B8D, 0x11B8E, 0x0, 0x0, 0x0, 0x0, 0x4B93, 0x0, 0x4B95, 0x4B96, 0x4B97, 0x0, 0x40B99, 0x80B9A, 0x0, 0x11B9C, 0x0, 0x0, 0x4B9F, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x6BA9, 0x0, 0x0, 0x11BAC, 0x0, 0x0, 0x0, 0x0, 0x81BB1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4BB7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2BBE, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8BC6, 0x0, 0x0, 0x0, 0x80BCA, 0x0, 0x11BCC, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80BD2, 0x0, 0x60BD4, 0x0, 0x0, 0x4BD7, 0x80BD8, 0x0, 0x80BDA, 0x80BDB, 0x0, 0x0, 0x80BDE, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x82BE4, 0x0, 0x0, 0x10BE7, 0x0, 0x0, 0x0, 0x1BEB, 0x0, 0x0, 0x0, 0x0, 0x14BF0, 0x0, 0x0, 0x22BF3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80BFA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0xC00, 0xC01, 0xC02, 0x0, 0xC04, 0x0, 0x0, 0x0, 0xC08, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xC10, 0x0, 0x0, 0xBC13, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40C19, 0x24C1A, 0x0, 0x88C1C, 0x0, 0x0, 0x0, 
0xC20, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21C26, 0x0, 0x0, 0xA2C29, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2C3E, 0x0, 
0xC40, 0x0, 0x0, 0xC0C43, 0x0, 0x0, 0x8C46, 0x0, 0x0, 0x0, 0x24C4A, 0x0, 0x43C4C, 0x0, 0x0, 0x0, 0x0, 0x0, 0x24C52, 0x0, 0x0, 0x0, 0x0, 0x0, 0x24C58, 0x0, 0x24C5A, 0x24C5B, 0x0, 0x0, 0x24C5E, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1C6B, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x24C7A, 0x0, 0x0, 0x0, 0x0, 0x0, 
0xC80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8C86, 0x0, 0x0, 0x40C89, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40C91, 0x0, 0x0, 0x32C94, 0x0, 0x0, 0x4C97, 0x40C98, 0x40C99, 0x0, 0x40C9B, 0x0, 0x40C9D, 0x0, 0x0, 
0x0, 0x18CA1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x42CA7, 0x0, 0x0, 0x0, 0x1CAB, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40CB9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x8CC2, 0x0, 0x8CC4, 0x0, 0x8CC6, 0x8CC7, 0x0, 0x0, 0x0, 0x1CCB, 0x0, 0x20CCD, 0x8CCE, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8CD6, 0x0, 0x0, 0x40CD9, 0x24CDA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x1CE3, 0x0, 0x0, 0x8CE6, 0x0, 0x0, 0x1CE9, 0x1CEA, 0x1CEB, 0x0, 0x0, 0x0, 0x1CEF, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xACF8, 0x0, 0x0, 0x1CFB, 0x0, 0x0, 0x50CFE, 0x0, 
0xD00, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8D06, 0x0, 0x0, 0x40D09, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40D11, 0x0, 0x0, 0x0, 0x0, 0x0, 0xA0D17, 0x40D18, 0x40D19, 0x0, 0x40D1B, 0x0, 0x40D1D, 0x2D1E, 0x0, 
0x0, 0x0, 0x0, 0x0, 0xD0D24, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x9D2D, 0x2D2E, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2D36, 0x0, 0x0, 0x40D39, 0x2D3A, 0x0, 0x2D3C, 0x0, 0x2D3E, 0x2D3F, 
0x0, 0x31D41, 0x8D42, 0x0, 0x8D44, 0x0, 0x8D46, 0x8D47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x84D4D, 0x8D4E, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8D56, 0x0, 0x0, 0x40D59, 0x24D5A, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8D66, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x41D72, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x98D7B, 0x0, 0x0, 0x2D7E, 0x0, 
0x0, 0x40D81, 0x8D82, 0x0, 0x8D84, 0x0, 0x8D86, 0x8D87, 0x40D88, 0x40D89, 0x0, 0x40D8B, 0x0, 0x40D8D, 0x8D8E, 0x0, 0x40D90, 0x40D91, 0x0, 0x40D93, 0x0, 0x40D95, 0x8D96, 0x0, 0x40D98, 0x40D99, 0x40D9A, 0x40D9B, 0x40D9C, 0x40D9D, 0x0, 0x40D9F, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8DA6, 0x0, 0x0, 0x40DA9, 0x30DAA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40DB1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40DB8, 0x40DB9, 0x0, 0x40DBB, 0x0, 0x40DBD, 0x2DBE, 0x0, 
0x8DC0, 0x0, 0x8DC2, 0x8DC3, 0x8DC4, 0x8DC5, 0x8DC6, 0x8DC7, 0x0, 0x40DC9, 0x8DCA, 0x0, 0x8DCC, 0x0, 0x8DCE, 0x8DCF, 0x0, 0x40DD1, 0x8DD2, 0x0, 0x8DD4, 0x0, 0x8DD6, 0x8DD7, 0x40DD8, 0x40DD9, 0x0, 0x40DDB, 0x0, 0x40DDD, 0x8DDE, 0x0, 
0x0, 0x0, 0x8DE2, 0x0, 0x8DE4, 0x0, 0x8DE6, 0x8DE7, 0x0, 0x0, 0x0, 0x1DEB, 0x0, 0x0, 0x8DEE, 0x0, 0x14DF0, 0x0, 0x0, 0x22DF3, 0x0, 0x0, 0x8DF6, 0x0, 0x0, 0x40DF9, 0x0, 0x0, 0xA1DFC, 0x0, 0x0, 0x0, 
0xE00, 0x0, 0x0, 0xC0E03, 0x0, 0x0, 0x21E06, 0x0, 0x0, 0x0, 0x0, 0x0, 0x88E0C, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x88E14, 0x0, 0x0, 0x4E17, 0x88E18, 0x0, 0x0, 0x0, 0x88E1C, 0x88E1D, 0x88E1E, 0x0, 
0x0, 0x18E21, 0x21E22, 0x0, 0x21E24, 0x0, 0x21E26, 0x21E27, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21E2E, 0x0, 0x46E30, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21E36, 0x0, 0x0, 0x0, 0x0, 0x0, 0x88E3C, 0x0, 0x0, 0x0, 
0x0, 0xC0E41, 0xC0E42, 0xC0E43, 0x0, 0x0, 0x0, 0xC0E47, 0x0, 0x0, 0x0, 0xC0E4B, 0x0, 0x20E4D, 0x0, 0x0, 0x0, 0x0, 0x0, 0xC0E53, 0x0, 0x0, 0x0, 0x0, 0x0, 0x12E59, 0x24E5A, 0x0, 0x88E5C, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0xC0E63, 0x0, 0x0, 0x21E66, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xEE6F, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x50E7E, 0x0, 
0x0, 0x18E81, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4E87, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20E8D, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4E93, 0x0, 0x4E95, 0x4E96, 0x4E97, 0x0, 0x40E99, 0x0, 0x0, 0x88E9C, 0x0, 0x0, 0x4E9F, 
0x18EA0, 0x18EA1, 0x0, 0x18EA3, 0x0, 0x18EA5, 0x21EA6, 0x0, 0x0, 0x18EA9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x18EB1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4EB7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x50EBE, 0x0, 
0x0, 0x0, 0x0, 0xC0EC3, 0x0, 0x20EC5, 0x8EC6, 0x0, 0x0, 0x20EC9, 0x0, 0x0, 0x20ECC, 0x20ECD, 0x0, 0x20ECF, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4ED7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20EDD, 0x50EDE, 0x0, 
0x0, 0x18EE1, 0x0, 0x0, 0x82EE4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1EEB, 0x0, 0x20EED, 0x50EEE, 0x0, 0x0, 0x0, 0x0, 0x22EF3, 0x0, 0x0, 0x50EF6, 0x0, 0x0, 0x0, 0x50EFA, 0x0, 0x50EFC, 0x0, 0x50EFE, 0x50EFF, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x28F0B, 0x0, 0x0, 0x44F0E, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40F19, 0x0, 0x0, 0x88F1C, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x21F26, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x81F31, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x34F3D, 0x2F3E, 0x0, 
0x0, 0x0, 0x0, 0xC0F43, 0x0, 0x0, 0x8F46, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xCF51, 0x0, 0x0, 0x60F54, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10F67, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x22F73, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0xA4F80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x8F86, 0x0, 0x0, 0x40F89, 0x0, 0x0, 0x11F8C, 0x0, 0x0, 0x0, 0x0, 0x40F91, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4F97, 0x40F98, 0x40F99, 0x0, 0x40F9B, 0x0, 0x40F9D, 0x0, 0x0, 
0x0, 0x18FA1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x22FB3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40FB9, 0xDFBA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x8FC2, 0x0, 0x8FC4, 0x0, 0x8FC6, 0x8FC7, 0x0, 0x0, 0x0, 0x0, 0x0, 0x20FCD, 0x8FCE, 0x0, 0x0, 0x0, 0x0, 0x22FD3, 0x0, 0x0, 0x8FD6, 0x0, 0x0, 0x40FD9, 0x80FDA, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x22FE3, 0x0, 0x45FE5, 0x8FE6, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x22FF1, 0x22FF2, 0x22FF3, 0x0, 0x0, 0x0, 0x22FF7, 0x0, 0x0, 0x0, 0x22FFB, 0x0, 0x0, 0x50FFE, 0x0
};

long doGolay208(char bitarray[20])
{
	int i;
	long codeword, ecc, syndrome, mask;
        codeword = 0L;
        ecc = 0L;
	for(i = 0; i < 20; i++)
	{
		codeword <<= 1;
		codeword |= (bitarray[i] - 48);
	}
	for(i = 0; i < 8; i++)
	{
		if((codeword & Golay208Gen[i]) > 0xfff)
			ecc ^= Golay208Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0L)
		return 0L;  // No error
        mask = 0xfffL;
	syndrome = Golay208Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x80000L;
	for(i = 0; i < 20; i++)
	{
		bitarray[i] = (syndrome & mask)?'1':'0';
		mask >>= 1;
	}
	return 0L;
}

// Hamming (7, 4, 3)

static int Hamming743Gen[4] = {0x45, 0x27, 0x16, 0x0b};

static int Hamming743Table[8] = {
 0x00, 0x01, 0x02, 0x0b, 0x04, 0x45, 0x16, 0x27

};

int doHamming743(char bitarray[7])
{
	int i;
	int codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 7; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 4; i++)
	{
		if((codeword & Hamming743Gen[i]) > 0x7)
			ecc ^= Hamming743Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0x7;
	syndrome = Hamming743Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x40;
	for(i = 0; i < 7; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0;
}

// Hamming (13, 9, 3)

static int Hamming1393Gen[9] = {0x100f, 0x080e, 0x0407, 0x020a, 0x0105, 0x008b, 0x004c, 0x0026, 0x0013 };

static int Hamming1393Table[16] = {
 0x00, 0x01, 0x02, 0x0013, 0x04, 0x0105, 0x0026, 0x00407,
 0x08, 0x00, 0x0020A, 0x008b, 0x004c, 0x00, 0x80e, 0x100f
};

int doHamming1393(char bitarray[13])
{
	int i;
	int codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 13; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 9; i++)
	{
		if((codeword & Hamming1393Gen[i]) > 0x0f)
			ecc ^= Hamming1393Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0xf;
	syndrome = Hamming1393Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x1000;
	for(i = 0; i < 13; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0L;
}

// Hamming (15, 11, 3)


static int Hamming15113Gen[11] = {0x4009, 0x200d, 0x100f, 0x080e, 0x0407, 0x020a, 0x0105, 0x008b, 0x004c, 0x0026, 0x0013 };

static int Hamming15113Table[16] = {
 0x00, 0x01, 0x02, 0x0013, 0x04, 0x0105, 0x0026, 0x00407,
 0x08, 0x4009, 0x0020A, 0x008b, 0x004c, 0x200d, 0x80e, 0x100f
};

int doHamming15113(char bitarray[15])
{
	int i;
	int codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 15; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 11; i++)
	{
		if((codeword & Hamming15113Gen[i]) > 0xf)
			ecc ^= Hamming15113Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0xf;
	syndrome = Hamming15113Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x4000;
	for(i = 0; i < 15; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0L;
}

// Hamming (16, 11, 4)

static int Hamming16114Gen[11] = {0x8013, 0x401a, 0x201f, 0x101c, 0x080e, 0x0415, 0x020b, 0x0116, 0x0099, 0x004d, 0x0027 };

static int Hamming16114Table[32] = {
 0x00, 0x01, 0x02, 0x00, 0x04, 0x00, 0x00, 0x0027,
 0x08, 0x0099, 0x00, 0x020b, 0x00, 0x004d, 0x80e, 0x00,
 0x10, 0x00, 0x00, 0x8013, 0x00, 0x0415, 0x0116, 0x00,
 0x00, 0x00, 0x401a, 0x00, 0x101c, 0x00, 0x00, 0x201f
};

int doHamming16114(char bitarray[16])
{
	int i;
	int codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 16; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 11; i++)
	{
		if((codeword & Hamming16114Gen[i]) > 0x1f)
			ecc ^= Hamming16114Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0x1f;
	syndrome = Hamming16114Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x8000;
	for(i = 0; i < 16; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0L;
}

// Hamming (17, 12, 3)

static long Hamming17123Gen[12] = {0x1001b, 0x0801f, 0x0401d, 0x0201c, 0x0100e,0x00807, 0x00411, 0x0021a, 0x0010d, 0x00094, 0x0004A, 0x00025};

static long Hamming17123Table[32] = {
 0x00, 0x01, 0x02, 0x00, 0x04, 0x00025, 0x00, 0x00807,
 0x08, 0x00, 0x0004A, 0x00, 0x00, 0x0010d, 0x0100e, 0x00,
 0x10, 0x00411, 0x00, 0x00, 0x00094, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x0021a, 0x1001b, 0x0201c, 0x0401d, 0x00, 0x0801f,
 
};

long doHamming17123(char bitarray[17])
{
	int i;
	long codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 17; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 12; i++)
	{
		if((codeword & Hamming17123Gen[i]) > 0x1f)
			ecc ^= Hamming17123Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0x1f;
	syndrome = Hamming17123Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x10000;
	for(i = 0; i < 17; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0L;
}

// QR (16, 7, 6)

static int QR1676Gen[7] = {0x804f, 0x411e, 0x21b7, 0x11e2, 0x09c9, 0x04e5, 0x0273};

static int QR1676Table[512] = {
 0x00, 0x01, 0x02, 0x00, 0x04, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x804f,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x0273, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x04e5, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 
 0x100, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x411e, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x21b7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09c9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x11e2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

};

int doQR1676(char bitarray[16])
{
	int i;
	int codeword, ecc, syndrome, mask;
        codeword = 0;
        ecc = 0;
	for(i = 0; i < 16; i++)
	{
		codeword <<= 1;
		codeword |= bitarray[i];
	}
	for(i = 0; i < 7; i++)
	{
		if((codeword & QR1676Gen[i]) > 0x1ff)
			ecc ^= QR1676Gen[i];
	}
	syndrome = ecc ^ codeword;
        if(syndrome == 0)
		return 0;  // No error
        mask = 0x1ff;
	syndrome = QR1676Table[syndrome & mask];
	syndrome ^= codeword;  // syndrome now has corrected bits
	if(syndrome == codeword) // Non correctable error
		return codeword ^ ecc; // indicate error
	mask = 0x8000;
	for(i = 0; i < 16; i++)
	{
		bitarray[i] = (syndrome & mask)?1:0;
		mask >>= 1;
	}
	return 0L;
}

// CRC-8
static unsigned char cCRC8;
void initCRC8()
{
  cCRC8 = 0;
}
unsigned char getCRC8()
{
  return cCRC8;
}
void doCRC8(char bit)
{
   char shiftFlag = 0;
   if(cCRC8 & 0x80)
     shiftFlag = 1;
   cCRC8 <<= 1;
   if (bit ^ shiftFlag)
     cCRC8 ^= 0x07;
}
// CRC-16

static unsigned short cCRC16;
void initCRC16()
{
  cCRC16 = 0x0000;
}
unsigned short getCRC16()
{
  return cCRC16;
}
void doCRC16(char bit)
{
   char shiftFlag = 0;
   if(cCRC16 & 0x8000)
     shiftFlag = 1;
   cCRC16 <<= 1;
    if (shiftFlag ^ bit)
     cCRC16 ^= 0x1021;
}
// Comment section from the original rs.c file
/* This program is an encoder/decoder for Reed-Solomon codes. Encoding is in
   systematic form, decoding via the Berlekamp iterative algorithm.
   In the present form , the constants mm, nn, tt, and kk=nn-2tt must be
   specified  (the double letters are used simply to avoid clashes with
   other n,k,t used in other programs into which this was incorporated!)
   Also, the irreducible polynomial used to generate GF(2**mm) must also be
   entered -- these can be found in Lin and Costello, and also Clark and Cain.

   The representation of the elements of GF(2**m) is either in index form,
   where the number is the power of the primitive element alpha, which is
   convenient for multiplication (add the powers modulo 2**m-1) or in
   polynomial form, where the bits represent the coefficients of the
   polynomial representation of the number, which is the most convenient form
   for addition.  The two forms are swapped between via lookup tables.
   This leads to fairly messy looking expressions, but unfortunately, there
   is no easy alternative when working with Galois arithmetic.

   The code is not written in the most elegant way, but to the best
   of my knowledge, (no absolute guarantees!), it works.
   However, when including it into a simulation program, you may want to do
   some conversion of global variables (used here because I am lazy!) to
   local variables where appropriate, and passing parameters (eg array
   addresses) to the functions  may be a sensible move to reduce the number
   of global variables and thus decrease the chance of a bug being introduced.

   This program does not handle erasures at present, but should not be hard
   to adapt to do this, as it is just an adjustment to the Berlekamp-Massey
   algorithm. It also does not attempt to decode past the BCH bound -- see
   Blahut "Theory and practice of error control codes" for how to do this.

              Simon Rockliff, University of Adelaide   21/9/89

   26/6/91 Slight modifications to remove a compiler dependent bug which hadn't
           previously surfaced. A few extra comments added for clarity.
           Appears to all work fine, ready for posting to net!

                  Notice
                 --------
   This program may be freely modified and/or given to whoever wants it.
   A condition of such distribution is that the author's contribution be
   acknowledged by his name being left in the comments heading the program,
   however no responsibility is accepted for any financial or other loss which
   may result from some unforseen errors or malfunctioning of the program
   during use.
                                 Simon Rockliff, 26th June 1991
*/

#define mm  8           /* RS code over GF(2**8) - change to suit */
#define nn  255          /* nn=2**mm -1   length of codeword */
#define tt  2           /* number of errors that can be corrected */
#define kk  252           /* kk = nn-2*tt  */

static int pp [mm+1] = { 1, 0, 1, 1, 1, 0, 0, 0, 1} ; /* specify irreducible polynomial coeffts */
static int alpha_to [nn+1], index_of [nn+1], gg [nn-kk+1] ;
static int recd [nn];//, data [kk], bb [nn-kk] ;
static int rsInput [nn];


static void generate_gf()
/* generate GF(2**mm) from the irreducible polynomial p(X) in pp[0]..pp[mm]
   lookup tables:  index->polynomial form   alpha_to[] contains j=alpha**i;
                   polynomial form -> index form  index_of[j=alpha**i] = i
   alpha=2 is the primitive element of GF(2**mm)
*/
 {
   register int i, mask ;

  mask = 1 ;
  alpha_to[mm] = 0 ;
  for (i=0; i<mm; i++)
   { alpha_to[i] = mask ;
     index_of[alpha_to[i]] = i ;
     if (pp[i]!=0)
       alpha_to[mm] ^= mask ;
     mask <<= 1 ;
   }
  index_of[alpha_to[mm]] = mm ;
  mask >>= 1 ;
  for (i=mm+1; i<nn; i++)
   { if (alpha_to[i-1] >= mask)
        alpha_to[i] = alpha_to[mm] ^ ((alpha_to[i-1]^mask)<<1) ;
     else alpha_to[i] = alpha_to[i-1]<<1 ;
     index_of[alpha_to[i]] = i ;
   }
  index_of[0] = -1 ;
 }


static void gen_poly()
/* Obtain the generator polynomial of the tt-error correcting, length
  nn=(2**mm -1) Reed Solomon code  from the product of (X+alpha**i), i=1..2*tt
*/
 {
   register int i,j ;

   gg[0] = 2 ;    /* primitive element alpha = 2  for GF(2**mm)  */
   gg[1] = 1 ;    /* g(x) = (X+alpha) initially */
   for (i=2; i<=nn-kk; i++)
    { gg[i] = 1 ;
      for (j=i-1; j>0; j--)
        if (gg[j] != 0)  gg[j] = gg[j-1]^ alpha_to[(index_of[gg[j]]+i)%nn] ;
        else gg[j] = gg[j-1] ;
      gg[0] = alpha_to[(index_of[gg[0]]+i)%nn] ;     /* gg[0] can never be zero */
    }
   /* convert gg[] to index form for quicker encoding */
   for (i=0; i<=nn-kk; i++)  gg[i] = index_of[gg[i]] ;
 }


static int decode_rs()
/* assume we have received bits grouped into mm-bit symbols in recd[i],
   i=0..(nn-1),  and recd[i] is index form (ie as powers of alpha).
   We first compute the 2*tt syndromes by substituting alpha**i into rec(X) and
   evaluating, storing the syndromes in s[i], i=1..2tt (leave s[0] zero) .
   Then we use the Berlekamp iteration to find the error location polynomial
   elp[i].   If the degree of the elp is >tt, we cannot correct all the errors
   and hence just put out the information symbols uncorrected. If the degree of
   elp is <=tt, we substitute alpha**i , i=1..n into the elp to get the roots,
   hence the inverse roots, the error location numbers. If the number of errors
   located does not equal the degree of the elp, we have more than tt errors
   and cannot correct them.  Otherwise, we then solve for the error value at
   the error location and correct the error.  The procedure is that found in
   Lin and Costello. For the cases where the number of errors is known to be too
   large to correct, the information symbols as received are output (the
   advantage of systematic encoding is that hopefully some of the information
   symbols will be okay and that if we are in luck, the errors are in the
   parity part of the transmitted codeword).  Of course, these insoluble cases
   can be returned as error flags to the calling routine if desired.   */
 {
   register int i,j,u,q ;
   int elp[nn-kk+2][nn-kk], d[nn-kk+2], l[nn-kk+2], u_lu[nn-kk+2], s[nn-kk+1] ;
   int count=0, syn_error=0, root[tt], loc[tt], z[tt+1], err[nn], reg[tt+1] ;

/* first form the syndromes */
   for (i=1; i<=nn-kk; i++)
    { s[i] = 0 ;
      for (j=0; j<nn; j++)
        if (recd[j]!=-1)
          s[i] ^= alpha_to[(recd[j]+i*j)%nn] ;      /* recd[j] in index form */
/* convert syndrome from polynomial form to index form  */
      if (s[i]!=0)  syn_error=1 ;        /* set flag if non-zero syndrome => error */
      s[i] = index_of[s[i]] ;
    } ;

   if (syn_error)       /* if errors, try and correct */
    {
/* compute the error location polynomial via the Berlekamp iterative algorithm,
   following the terminology of Lin and Costello :   d[u] is the 'mu'th
   discrepancy, where u='mu'+1 and 'mu' (the Greek letter!) is the step number
   ranging from -1 to 2*tt (see L&C),  l[u] is the
   degree of the elp at that step, and u_l[u] is the difference between the
   step number and the degree of the elp.
*/
/* initialise table entries */
      d[0] = 0 ;           /* index form */
      d[1] = s[1] ;        /* index form */
      elp[0][0] = 0 ;      /* index form */
      elp[1][0] = 1 ;      /* polynomial form */
      for (i=1; i<nn-kk; i++)
        { elp[0][i] = -1 ;   /* index form */
          elp[1][i] = 0 ;   /* polynomial form */
        }
      l[0] = 0 ;
      l[1] = 0 ;
      u_lu[0] = -1 ;
      u_lu[1] = 0 ;
      u = 0 ;

      do
      {
        u++ ;
        if (d[u]==-1)
          { l[u+1] = l[u] ;
            for (i=0; i<=l[u]; i++)
             {  elp[u+1][i] = elp[u][i] ;
                elp[u][i] = index_of[elp[u][i]] ;
             }
          }
        else
/* search for words with greatest u_lu[q] for which d[q]!=0 */
          { q = u-1 ;
            while ((d[q]==-1) && (q>0)) q-- ;
/* have found first non-zero d[q]  */
            if (q>0)
             { j=q ;
               do
               { j-- ;
                 if ((d[j]!=-1) && (u_lu[q]<u_lu[j]))
                   q = j ;
               }while (j>0) ;
             } ;

/* have now found q such that d[u]!=0 and u_lu[q] is maximum */
/* store degree of new elp polynomial */
            if (l[u]>l[q]+u-q)  l[u+1] = l[u] ;
            else  l[u+1] = l[q]+u-q ;

/* form new elp(x) */
            for (i=0; i<nn-kk; i++)    elp[u+1][i] = 0 ;
            for (i=0; i<=l[q]; i++)
              if (elp[q][i]!=-1)
                elp[u+1][i+u-q] = alpha_to[(d[u]+nn-d[q]+elp[q][i])%nn] ;
            for (i=0; i<=l[u]; i++)
              { elp[u+1][i] ^= elp[u][i] ;
                elp[u][i] = index_of[elp[u][i]] ;  /*convert old elp value to index*/
              }
          }
        u_lu[u+1] = u-l[u+1] ;

/* form (u+1)th discrepancy */
        if (u<nn-kk)    /* no discrepancy computed on last iteration */
          {
            if (s[u+1]!=-1)
                   d[u+1] = alpha_to[s[u+1]] ;
            else
              d[u+1] = 0 ;
            for (i=1; i<=l[u+1]; i++)
              if ((s[u+1-i]!=-1) && ((u+1)<(nn-kk+2)) && (i<(nn-kk)) && (elp[u+1][i]!=0))
                d[u+1] ^= alpha_to[(s[u+1-i]+index_of[elp[u+1][i]])%nn] ;
            d[u+1] = index_of[d[u+1]] ;    /* put d[u+1] into index form */
          }
      } while ((u<nn-kk) && (l[u+1]<=tt)) ;

      u++ ;
      if (l[u]<=tt)         /* can correct error */
       {
/* put elp into index form */
         for (i=0; i<=l[u]; i++)   elp[u][i] = index_of[elp[u][i]] ;

/* find roots of the error location polynomial */
         for (i=1; i<=l[u]; i++)
           reg[i] = elp[u][i] ;
         count = 0 ;
         for (i=1; i<=nn; i++)
          {  q = 1 ;
             for (j=1; j<=l[u]; j++)
              if (reg[j]!=-1)
                { reg[j] = (reg[j]+j)%nn ;
                  q ^= alpha_to[reg[j]] ;
                } ;
             if (!q)        /* store root and error location number indices */
              { root[count] = i;
                loc[count] = nn-i ;
                count++ ;
              };
          } ;
         if (count==l[u])    /* no. roots = degree of elp hence <= tt errors */
          {
/* form polynomial z(x) */
           for (i=1; i<=l[u]; i++)        /* Z[0] = 1 always - do not need */
            { if ((s[i]!=-1) && (elp[u][i]!=-1))
                 z[i] = alpha_to[s[i]] ^ alpha_to[elp[u][i]] ;
              else if ((s[i]!=-1) && (elp[u][i]==-1))
                      z[i] = alpha_to[s[i]] ;
                   else if ((s[i]==-1) && (elp[u][i]!=-1))
                          z[i] = alpha_to[elp[u][i]] ;
                        else
                          z[i] = 0 ;
              for (j=1; j<i; j++)
                if ((s[j]!=-1) && (elp[u][i-j]!=-1))
                   z[i] ^= alpha_to[(elp[u][i-j] + s[j])%nn] ;
              z[i] = index_of[z[i]] ;         /* put into index form */
            } ;

  /* evaluate errors at locations given by error location numbers loc[i] */
           for (i=0; i<nn; i++)
             { err[i] = 0 ;
               if (recd[i]!=-1)        /* convert recd[] to polynomial form */
                 recd[i] = alpha_to[recd[i]] ;
               else  recd[i] = 0 ;
             }
           for (i=0; i<l[u]; i++)    /* compute numerator of error term first */
            { err[loc[i]] = 1;       /* accounts for z[0] */
              for (j=1; j<=l[u]; j++)
                if (z[j]!=-1)
                  err[loc[i]] ^= alpha_to[(z[j]+j*root[i])%nn] ;
              if (err[loc[i]]!=0)
               { err[loc[i]] = index_of[err[loc[i]]] ;
                 q = 0 ;     /* form denominator of error term */
                 for (j=0; j<l[u]; j++)
                   if (j!=i)
                     q += index_of[1^alpha_to[(loc[j]+root[i])%nn]] ;
                 q = q % nn ;
                 err[loc[i]] = alpha_to[(err[loc[i]]-q+nn)%nn] ;
                 recd[loc[i]] ^= err[loc[i]] ;  /*recd[i] must be in polynomial form */
               }
            }
          }
         else    /* no. roots != degree of elp => >tt errors and cannot solve */
         {
           for (i=0; i<nn; i++)        /* could return error flag if desired */
               if (recd[i]!=-1)        /* convert recd[] to polynomial form */
                 recd[i] = alpha_to[recd[i]] ;
               else  recd[i] = 0 ;     /* just output received codeword as is */
           return 1;
         }
       }
     else         /* elp has degree has degree >tt hence cannot solve */
     {
       for (i=0; i<nn; i++)       /* could return error flag if desired */
          if (recd[i]!=-1)        /* convert recd[] to polynomial form */
            recd[i] = alpha_to[recd[i]] ;
          else  recd[i] = 0 ;     /* just output received codeword as is */
       return 2;
     }
    }
   else       /* no non-zero syndromes => no errors: output received codeword */
   {
    for (i=0; i<nn; i++)
       if (recd[i]!=-1)        /* convert recd[] to polynomial form */
         recd[i] = alpha_to[recd[i]] ;
       else  recd[i] = 0 ;
   }
   return 0;
 }
static int rs1294InitNeeded = 1;
void initRS1294()
{
  int i;
  if(rs1294InitNeeded)
  {
    /* generate the Galois Field GF(2**mm) */
    generate_gf() ;

    /* compute the generator polynomial for this RS code */
    gen_poly() ;
    rs1294InitNeeded = 0;
  }
  for  (i=0; i<nn; i++)
  {
    recd[i] = 0 ;
    rsInput[i] = 0 ;
  }
}
int doRS1294(char bitarray[97])
{
  int i, j, errorFlag;
  for(i = 0, j = 88; i < 12; i++, j -= 8)
  {
    rsInput[i] = ((bitarray[j] != 0)?  128 : 0) |
              ((bitarray[j+1] != 0)? 64 : 0) |
              ((bitarray[j+2] != 0)? 32 : 0) |
              ((bitarray[j+3] != 0)? 16 : 0) |
              ((bitarray[j+4] != 0)?  8 : 0) |
              ((bitarray[j+5] != 0)?  4 : 0) |
              ((bitarray[j+6] != 0)?  2 : 0) |
              ((bitarray[j+7] != 0)?  1 : 0);
  }
  for (i=0; i<nn; i++)
     recd[i] = index_of[rsInput[i]] ;          /* put recd[i] into index form */

/* decode recv[] */
  errorFlag = decode_rs() ;         /* recd[] is returned in polynomial form */
  for(i = 0, j = 88; i < 12; i++, j -= 8)
  {
    bitarray[j]   = ((recd[i] & 128)? 1 : 0);
    bitarray[j+1] = ((recd[i] &  64)? 1 : 0);
    bitarray[j+2] = ((recd[i] &  32)? 1 : 0);
    bitarray[j+3] = ((recd[i] &  16)? 1 : 0);
    bitarray[j+4] = ((recd[i] &   8)? 1 : 0);
    bitarray[j+5] = ((recd[i] &   4)? 1 : 0);
    bitarray[j+6] = ((recd[i] &   2)? 1 : 0);
    bitarray[j+7] = ((recd[i] &   1)? 1 : 0);
  }
  return errorFlag;
}


